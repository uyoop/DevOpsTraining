global:
  resolve_timeout: 5m
  smtp_smarthost: 'smtp.example.com:587'
  smtp_from: 'alertmanager@example.com'
  smtp_auth_username: 'your-username'
  smtp_auth_password: 'your-password'
  smtp_require_tls: true

# Templates for notifications
templates:
  - '/etc/alertmanager/*.tmpl'

# Route tree for alerts
route:
  receiver: 'default-receiver'
  group_by: ['alertname', 'severity']
  group_wait: 10s
  group_interval: 10s
  repeat_interval: 12h
  
  routes:
  # Critical alerts - immediate notification
  - match:
      severity: critical
    receiver: 'critical-alerts'
    repeat_interval: 1h
    continue: true
  
  # Warning alerts - standard notification
  - match:
      severity: warning
    receiver: 'warning-alerts'
    repeat_interval: 4h
  
  # Info alerts - low priority
  - match:
      severity: info
    receiver: 'info-alerts'
    repeat_interval: 24h

# Notification receivers
receivers:
- name: 'default-receiver'
  email_configs:
  - to: 'your-email@example.com'
    headers:
      Subject: '[Prometheus] {{ .GroupLabels.alertname }}'
    html: |
      <h2>Alert Summary</h2>
      <p><b>Alert:</b> {{ .GroupLabels.alertname }}</p>
      <p><b>Severity:</b> {{ .GroupLabels.severity }}</p>
      <p><b>Status:</b> {{ .Status }}</p>
      <hr>
      {{ range .Alerts }}
      <p><b>{{ .Labels.instance }}</b></p>
      <p>{{ .Annotations.description }}</p>
      {{ end }}

- name: 'critical-alerts'
  email_configs:
  - to: 'oncall@example.com'
    send_resolved: true
    headers:
      Subject: 'üö® [CRITICAL] {{ .GroupLabels.alertname }}'
  # Uncomment for Slack integration
  # slack_configs:
  # - api_url: 'YOUR_SLACK_WEBHOOK_URL'
  #   channel: '#alerts-critical'
  #   title: 'üö® Critical Alert: {{ .GroupLabels.alertname }}'
  #   text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'

- name: 'warning-alerts'
  email_configs:
  - to: 'team@example.com'
    send_resolved: true
    headers:
      Subject: '‚ö†Ô∏è  [WARNING] {{ .GroupLabels.alertname }}'

- name: 'info-alerts'
  email_configs:
  - to: 'monitoring@example.com'
    send_resolved: false
    headers:
      Subject: '‚ÑπÔ∏è  [INFO] {{ .GroupLabels.alertname }}'

# Inhibition rules - suppress alerts based on other alerts
inhibit_rules:
- source_match:
    severity: 'critical'
  target_match:
    severity: 'warning'
  equal: ['instance', 'alertname']

- source_match:
    alertname: 'InstanceDown'
  target_match_re:
    alertname: '.*'
  equal: ['instance']
