# ============================================================================
# TP16 - Harbor Production-Ready Configuration
# ============================================================================
# Environnement : Production
# Features : Traefik v3, PostgreSQL HA, Redis Sentinel, Monitoring, Alerting
# ============================================================================

# ==== Harbor Core ====
HARBOR_HOSTNAME=harbor.example.com
HARBOR_HTTP_PORT=80
HARBOR_HTTPS_PORT=443
HARBOR_ADMIN_PASSWORD=HarborAdminPassword123!
HARBOR_VERSION=v2.9.1

# ==== TLS/SSL ====
CERT_EMAIL=admin@example.com
ACME_SERVER=https://acme-v02.api.letsencrypt.org/directory
# Or for production: https://acme-v02.api.letsencrypt.org/directory
# Or for staging: https://acme-staging-v02.api.letsencrypt.org/directory

# ==== Traefik ====
TRAEFIK_DASHBOARD_HOST=traefik.example.com
TRAEFIK_DASHBOARD_USER=admin
TRAEFIK_DASHBOARD_PASSWORD=TraefikPassword123!
TRAEFIK_LOG_LEVEL=INFO
# Generate with: openssl passwd -apr1

# ==== PostgreSQL HA ====
POSTGRES_PASSWORD=PostgresPassword123!
POSTGRES_REPLICATION_PASSWORD=ReplicationPassword123!
POSTGRES_SUPERUSER=postgres
POSTGRES_DATABASE=harbor
POSTGRES_USER=harbor
POSTGRES_USER_PASSWORD=HarborDBPassword123!
PG_HA_SLOTS=3
PG_POOL_SIZE=20
PG_MAX_CONNECTIONS=100

# ==== Redis Sentinel ====
REDIS_PASSWORD=RedisPassword123!
REDIS_SENTINEL_PASSWORD=SentinelPassword123!
REDIS_QUORUM=2
REDIS_FAILOVER_TIMEOUT=3000
REDIS_PARALLEL_SYNCS=1

# ==== S3 Backend (optional) ====
S3_ENABLED=false
S3_ENDPOINT=s3.amazonaws.com
S3_REGION=us-east-1
S3_BUCKET=harbor-registry
S3_ACCESS_KEY=YOUR_ACCESS_KEY
S3_SECRET_KEY=YOUR_SECRET_KEY
S3_ENCRYPT=true

# ==== LDAP/OIDC ====
LDAP_ENABLED=false
LDAP_URL=ldap://ldap.example.com:389
LDAP_DN=cn=admin,dc=example,dc=com
LDAP_PASSWORD=LDAPPassword123!
LDAP_BASE_DN=dc=example,dc=com
LDAP_UID_ATTRIBUTE=uid
LDAP_SCOPE=2
LDAP_TIMEOUT=5
LDAP_VERIFY_CERT=true

OIDC_ENABLED=false
OIDC_ENDPOINT=https://oidc.example.com
OIDC_CLIENT_ID=harbor-app
OIDC_CLIENT_SECRET=OIDCClientSecret123!
OIDC_SCOPE=openid,profile,email

# ==== Monitoring ====
PROMETHEUS_RETENTION=30d
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_EVALUATION_INTERVAL=15s

GRAFANA_ADMIN_PASSWORD=GrafanaPassword123!
GRAFANA_SMTP_ENABLED=false
GRAFANA_SMTP_HOST=smtp.example.com
GRAFANA_SMTP_PORT=587
GRAFANA_SMTP_USER=notifications@example.com
GRAFANA_SMTP_PASSWORD=SMTPPassword123!

ALERTMANAGER_SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
ALERTMANAGER_EMAIL_FROM=alerts@example.com
ALERTMANAGER_EMAIL_TO=ops@example.com
ALERTMANAGER_SMTP_HOST=smtp.example.com
ALERTMANAGER_SMTP_PORT=587
ALERTMANAGER_SMTP_USER=notifications@example.com
ALERTMANAGER_SMTP_PASSWORD=SMTPPassword123!

# ==== Logging ====
LOKI_RETENTION_DAYS=30
LOKI_CHUNK_IDLE_PERIOD=3m
LOKI_CHUNK_RETAIN_PERIOD=1m

# ==== Trivy Security ====
TRIVY_ENABLED=true
TRIVY_SEVERITY=HIGH,CRITICAL
TRIVY_SKIP_UPDATE=false
TRIVY_OFFLINE_MODE=false

# ==== Backup/Restore ====
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_DESTINATION=./backups

# ==== Network ====
DOCKER_NETWORK=harbor-network
TRAEFIK_NETWORK=traefik-network
INTERNAL_NETWORK=harbor-internal

# ==== Container Limits ====
MEMORY_LIMIT=2g
CPU_LIMIT=2
MEMORY_RESERVATION=1g
CPU_RESERVATION=1

# ==== Notary (Content Trust) ====
NOTARY_ENABLED=true
NOTARY_SERVER_POSTGRES_PASSWORD=NotaryPassword123!

# ==== Custom CA ====
CUSTOM_CA_ENABLED=false
CUSTOM_CA_PATH=/path/to/ca.crt

# ==== Debug/Development ====
DEBUG_ENABLED=false
ENVIRONMENT=production
